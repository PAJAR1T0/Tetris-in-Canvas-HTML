var ie=Object.defineProperty;var se=(t,e,a)=>e in t?ie(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;var T=(t,e,a)=>(se(t,typeof e!="symbol"?e+"":e,a),a);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function a(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(o){if(o.ep)return;o.ep=!0;const n=a(o);fetch(o.href,n)}})();const le="/Tetris-in-Canvas-HTML/assets/cantRotate-CJ6KSpQz.mp3",ce="/Tetris-in-Canvas-HTML/assets/clearLine-C_qtc6-i.mp3",ue="/Tetris-in-Canvas-HTML/assets/gameOver-CVqtGQJh.mp3",de="/Tetris-in-Canvas-HTML/assets/inWait-DOiNGOZM.mp3",he="/Tetris-in-Canvas-HTML/assets/newPiece-DkezpbDb.mp3",fe="/Tetris-in-Canvas-HTML/assets/newRecord-CXw7s2ID.mp3",pe="/Tetris-in-Canvas-HTML/assets/nextLevel-dvHpZZOY.mp3",we="/Tetris-in-Canvas-HTML/assets/mainAudio1-CCOts2jb.mp3",me="/Tetris-in-Canvas-HTML/assets/mainAudio2-eH_XLQL4.mp3",ye="/Tetris-in-Canvas-HTML/assets/mainAudio3-Cn5wQOkh.mp3",ve="/Tetris-in-Canvas-HTML/assets/mainAudio4-CeCSvjUm.mp3";let I,O,P,H,x,S,m,D,N,R,G,X;const ge=()=>new Promise(t=>{I=new Audio(le),I.addEventListener("canplaythrough",()=>t(!0))}),Ae=()=>new Promise(t=>{O=new Audio(ce),O.addEventListener("canplaythrough",()=>t(!0))}),Le=()=>new Promise(t=>{P=new Audio(ue),P.addEventListener("canplaythrough",()=>t(!0))}),Me=()=>new Promise(t=>{D=new Audio(we),D.addEventListener("canplaythrough",()=>t(!0))}),xe=()=>new Promise(t=>{N=new Audio(me),N.addEventListener("canplaythrough",()=>t(!0))}),Pe=()=>new Promise(t=>{R=new Audio(ye),R.addEventListener("canplaythrough",()=>t(!0))}),Ee=()=>new Promise(t=>{G=new Audio(ve),G.addEventListener("canplaythrough",()=>t(!0))}),Ce=async()=>{await Me(),await xe(),await Pe(),await Ee(),X=[D,N,R,G]},Te=()=>new Promise(t=>{H=new Audio(he),H.addEventListener("canplaythrough",()=>t(!0))}),be=()=>new Promise(t=>{x=new Audio(fe),x.volume=.5,x.addEventListener("canplaythrough",()=>t(!0))}),ke=()=>new Promise(t=>{S=new Audio(pe),S.addEventListener("canplaythrough",()=>t(!0))}),Ie=()=>new Promise(t=>{m=new Audio(de),m.volume=.25,m.addEventListener("canplaythrough",()=>t(!0))}),Oe=()=>P.addEventListener("ended",()=>{m.play()}),He=async()=>{await ge(),await Ae(),await Le(),await Ce(),await Te(),await be(),await ke(),await Ie(),Oe()},Se="/Tetris-in-Canvas-HTML/assets/backgroundImage-D5AEUAsY.png";let _,p,i,j=!1,V=document.getElementById("app"),De=document.getElementById("loading");const ee=()=>{p=X[Math.floor(Math.random()*X.length)],p.loop=!0,p.volume=.5,p.play(),ae(),E||Ke(),_=setInterval(Ue,10)},Ne=()=>{ee()},Re=()=>window.addEventListener("keydown",()=>{j||Ne(),j=!0}),Ge=async()=>{let t=new Image;t.src=Se,await t.decode(),V.style.backgroundImage=`url(${t.src})`},Xe=async()=>{at(),await He(),await Ge(),V.removeChild(De),i=Ye(),Re()},A=10,F=A*2,u=Math.max(window.innerWidth*.2,350),d=u*2,M=u/A,Ye=()=>{const t=document.getElementById("app"),e=document.createElement("canvas"),a=e.getContext("2d");return e.width=u,e.height=d,t.appendChild(e),a};let b=!1;const Ke=()=>{window.addEventListener("keydown",t=>{if(!b){b=!0,E&&(We(),Qe(),Je(),tt(),ee());let e=t.key;if(e==="ArrowLeft"||e==="a")return v(-1);if(e==="ArrowRight"||e==="d")return v(1);if(e==="ArrowUp"||e==="w")return v("up");if(e==="ArrowDown"||e==="s"||t.code==="Space")return v("downKeyDown")}}),window.addEventListener("keyup",t=>{let e=t.key;(e==="ArrowDown"||e==="s"||t.code==="Space")&&v("upKeyDown"),b=!1})};let E=!1;const We=()=>E=!1,$e=()=>{clearInterval(_),E=!0,p.pause(),P.play(),p.currentTime=0,i.save(),i.beginPath(),i.fillStyle="white",i.fillRect(0,d/2*.9,u,d*.1),i.fill(),i.font='37px "Press Start 2P"',i.textAlign="center",i.textBaseline="middle",i.fillStyle="black",i.fillText("Game Over",u/2,d/2),i.fill(),i.restore()},Q=40,z=10,te=20,ne=2e3,Be=ne/te,Fe=Q/te;let J=Q,Y=0,w=40;const Qe=()=>w=40,v=t=>{if(Y=Math.floor(f/Be),w=Math.floor(f)<ne?Q-Math.round(Fe*Y):z,w!==J&&(S.play(),J=w),typeof t=="number"){let e=l.pop(),a=!1;e.forEach(r=>{(r.x-1<0&&t<0||r.x+1===A&&t>0)&&(a=!0),l.forEach(o=>{o.forEach(n=>{a=r.x-1===n.x&&r.y===n.y&&t<0||r.x+1===n.x&&r.y===n.y&&t>0?!0:a})})}),a||e.forEach(r=>{r.move(t)}),l.push(e);return}if(t==="downKeyDown"&&(w=z),t==="up"){let e=l.pop();je(e),l.push(e)}},qe=()=>{let t=[];for(let e=F-1;e>=0;e--){if(l.forEach((a,r)=>{a.forEach(o=>{o.y===e&&t.push(r)})}),t.length===A){B(et),t=t.filter((a,r,o)=>o.indexOf(a)===r),t.sort((a,r)=>a-r);for(let a=0;a<t.length;a++){let r=t[a]-a;l.splice(r,1)}O.play()}t=[]}};let k=0;const Ue=()=>{m.pause(),m.currentTime=0,k+=1,i.clearRect(0,0,u,d);let t=l.pop(),e=!1;if(t.forEach(a=>{e||(e=a.colitionChecker())}),!e&&k%w===0&&(B(_e),t.forEach(a=>{a.gravity()}),qe()),k%10===0&&l.forEach((a,r)=>{let o=!1;a.forEach(n=>{o||(o=n.colitionChecker(r))}),o||a.forEach(n=>{n.gravity()})}),l.push(t),l.forEach(a=>{a.forEach(r=>{r.draw()})}),rt(),e){let a=!1;t.forEach(r=>{r.y===0&&(a=!0)}),a&&$e()}e&&(B(Ve),ae(),H.play())};let K=Math.PI/2,h=K;const Ze=()=>h=0,je=t=>{h-=K;let e=t[1],a=[],r=[],o=!1;if(t.forEach(n=>{let c=n.initialX-e.x,Z=n.initialY-e.y,y=e.x+Math.round(c*Math.cos(h)-Z*Math.sin(h)),C=e.y+Math.round(c*Math.sin(h)+Z*Math.cos(h));a.push(y),r.push(C),l.forEach(oe=>{oe.forEach(L=>{o=y-1===L.x&&C===L.y||y+1===L.x&&C===L.y?!0:o})}),(y<0||y>A-1)&&(o=!0)}),o)return I.play(),h+=K;t.forEach((n,c)=>{n.x=a[c],n.y=r[c]})};class s{constructor(e,a,r){T(this,"initialX");T(this,"initialY");this.x=e,this.y=a,this.color=r,this.initialX=e,this.initialY=a}draw(){i.save(),i.beginPath(),i.fillStyle=this.color,i.strokeStyle="gray",i.rect(this.x*M,this.y*M,M,M),i.fill(),i.stroke(),i.restore()}move(e){this.x+=e,this.initialX+=e}gravity(){this.y+=1,this.initialY+=1}colitionChecker(e=9999){let a=!1;return this.y===F-1&&(a=!0),l.forEach((r,o)=>{e!==o&&r.forEach(n=>{this.y+1===n.y&&this.x===n.x&&(a=!0)})}),a}}let l=[];const ze=["#00e4ff","#ff8d01","#ff8d01","#faff00","#9e0196","#f60001","#68b624"],Je=()=>l=[],ae=()=>{let t=Math.round(Math.random()*6),e=ze[t],a=[];switch(t){case 0:{let r=Math.round(Math.random()*6),o=0;for(let n=0;n<4;n++)a.push(new s(r+n,o,e));break}case 1:{let r=Math.round(Math.random()*7),o=1;for(let n=0;n<3;n++)a.push(new s(r+n,o,e)),n||a.push(new s(r+n,o-1,e));break}case 2:{let r=Math.round(Math.random()*7),o=1;for(let n=0;n<3;n++)a.push(new s(r+n,o,e)),n===2&&a.push(new s(r+n,o-1,e));break}case 3:{let r=Math.round(Math.random()*8),o=0;for(let n=0;n<2;n++)a.push(new s(r+n,o,e)),a.push(new s(r+n,o+1,e));break}case 4:{let r=Math.round(Math.random()*7),o=1;for(let n=0;n<3;n++)a.push(new s(r+n,o,e)),n===1&&a.push(new s(r+n,o-1,e));break}case 5:{let r=Math.round(Math.random()*7),o=1;for(let n=0;n<3;n++)switch(n){case 0:a.push(new s(r+n,o,e));break;case 1:a.push(new s(r+n,o-1,e)),a.push(new s(r+n,o,e));break;case 2:a.push(new s(r+n,o-1,e));break}break}case 6:{let r=Math.round(Math.random()*7),o=1;for(let n=0;n<3;n++)switch(n){case 0:a.push(new s(r+n,o-1,e));break;case 1:a.push(new s(r+n,o-1,e)),a.push(new s(r+n,o,e));break;case 2:a.push(new s(r+n,o,e));break}break}}l.push(a),Ze()};let q="00000",U="00000",g=0,re=20,W=!1,f=0,_e=re*.5/F,Ve=1+re*.5,et=50;const tt=()=>(W=!1,f=0),nt=()=>{localStorage.setItem("historicalPoints",q)},at=()=>{g=Number(localStorage.getItem("historicalPoints"))|0,U=$(g)},$=t=>{let e=Math.floor(t),a=e.toString().length;return a===1?`0000${e}`:a===2?`000${e}`:a===3?`00${e}`:`${e}`},B=t=>{f+=t,q=$(f),f>g&&(W||x.play(),W=!0,g=f,U=$(g),nt())},rt=()=>{i.save(),i.beginPath(),i.font='15px "Press Start 2P"',i.fillText(U,u*.02,d*.05),i.fillText(q,u*.77,d*.05),i.fill(),i.textAlign="center",i.fillText(`Level ${Y}`,u/2,d*.05),i.fill(),i.restore()};Xe();
